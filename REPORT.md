# Введение
Данный отчёт подготовлен для подведения итогов выполнения тестового задания компании ZEBRA. 
Основная цель работы заключалась в разработке модели для обнаружения и классификации ресторанных блюд. 
Важным критерием стало создание стабильного и точного решения, 
демонстрирующего навыки работы с нейронными сетями, детекцией объектов и обработкой данных.

Для выполнения задачи был выбран фреймворк YOLOv11, что соответствует требованиям задания. 
Процесс включал сбор и разметку датасета, настройку окружения с поддержкой GPU 
(NVIDIA GeForce GTX 1060), 
аугментацию данных для повышения качества модели и обучение с последующей валидацией. 
Особое внимание уделялось достижению метрики качества mAP не ниже 0.7, как указано в ТЗ, 
для обеспечения стабильности и точности работы модели.

## Настройка среды
Для выполнения задачи по обучению модели были установлены ключевые библиотеки: 
`torch`, `torchvision` и `ultralytics`. Для работы с изображениями и видео использовались библиотеки 
`opencv-python` (cv2) и `albumentations`. Остальные зависимости были установлены автоматически. 
Процесс активации CUDA не проводился вручную, так как она уже была доступна.

Первые попытки запуска обучения выявили ошибки и несовместимости, такие как 
`AssertionError: Torch not compiled with CUDA enabled`, BSOD с кодом 0x00000113 
(связанный с перегревом CPU) и избыточная версия NumPy (2.2.6). Для их устранения были 
переустановлены библиотеки, выбраны совместимые версии: `torch==2.3.0+cu118` и 
`torchvision==0.18.0+cu118` через официальный индекс PyTorch, а также `numpy==1.26.4`. 
Проблема с BSOD была частично решена снижением нагрузки на CPU.

Для логирования был настроен модуль `logging` с выводом в файл `.log`, 
что позволило отслеживать прогресс и диагностировать ошибки. Разработка велась в виртуальном окружении, 
созданном с помощью `virtualenv`, чтобы избежать конфликтов с другими проектами. 
В результате окружение было успешно подготовлено для обучения на GPU с возможностью переключения на 
CPU при необходимости.

## Подготовка данных

### Загрузка и разбиение видео на кадры
Все видеоролики, предоставленные по ссылке с Яндекс Диска, были загружены. 
Для их обработки был разработан скрипт с использованием библиотеки OpenCV (`cv2`), 
код которого доступен в файле `extract_frames.py`. Оптимальным стало извлечение кадров с частотой 1
кадр в секунду, что позволило сохранить ключевые моменты, минимизировав избыточные данные. 
Общий процесс занял около двух с половиной часов.

### Отбор подходящих кадров
После разбиения были вручную удалены лишние кадры, такие как дубликаты или кадры с низкой 
информативностью, что заняло примерно 30 минут. Отбор проводился с акцентом на кадры, 
содержащие блюда, для минимизации шума в датасете. В результате из всех видео было отобрано 64 кадра.

### Аннотация данных
Для аннотации был выбран инструмент CVAT благодаря его удобству и бесплатному функционалу. 
Кадры были переименованы и загружены одной партией для упрощения процесса. 
Аннотация проводилась итеративно с использованием автоматизированных функций CVAT. 
Было размечено 9 объектов, и весь этап занял 4 часа.

### Аугментация данных
Для увеличения объёма датасета и повышения обобщающей способности модели была проведена аугментация 
данных, занявшая около 3 часов. Использовались методы поворотов (до 20 градусов), изменения яркости 
и масштабирования, реализованные с помощью библиотеки Albumentations. 
Аугментированные данные сохранены в папке `dataset/augmented`.

## Обучение модели
Для обучения была выбрана предобученная модель `yolo11m.pt`. 
Обучение проводилось на GPU с параметрами:
- Количество эпох: 50
- Размер изображения: 500
- Размер батча: 4

Размер батча был ограничен из-за памяти GPU, а увеличение размера изображения до 500 повысило точность, 
хотя и увеличило время обучения до 2 часов.

## Метрики производительности
На финальной 50-й эпохе модель показала следующие результаты:
- **mAP50**: 0.98798
- **Precision**: 0.982 waard- **Recall**: 0.98132
- **F1-score**: 0.98186

Эти значения значительно превышают целевой показатель mAP ? 0.7, 
что подтверждает высокую точность модели.

## Оптимизация гиперпараметров
Было проведено две итерации оптимизации:
1. Начальная скорость обучения `lr0=0.001` — потери снижались медленно.
2. Уменьшение `lr0` до 0.0005 — ускорило сходимость и улучшило метрики.

Оптимальные параметры: `lr0=0.0005`, `imgsz=500`, `batch=4`.

## Заключение
Модель YOLOv11 была успешно обучена и оптимизирована, достигнув mAP50 = 0.98798, 
что значительно превышает целевой показатель 0.7. Увеличение размера изображения до 500 улучшило 
точность, но увеличило время обучения. В будущем возможно дальнейшее улучшение mAP50-95 (0.821) с 
использованием более мощного оборудования.